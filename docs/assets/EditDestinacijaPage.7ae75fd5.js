import{n as le}from"./AdminBar.3be4c6e5.js";import{K as se,e as ne,x as re,_ as ue,f as de,h as ce,V as E,j as M,i as fe,k as me}from"./VMain.ad086986.js";import{h as pe,_ as ve,m as S,i as x,K as he,k,l as ge,ax as be,a,x as O,F as T,q as z,af as Ve,aF as xe,ad as _,az as ke,O as we,n as je,r as q,o as ze,c as ye,w as n,s as Ce,b as R,t as A,f as Fe,v as $e,p as Pe,g as Se}from"./index.04e8cc8d.js";import{S as Oe,V as Te}from"./index.103af9d0.js";import{e as _e,f as Ae,g as Ne,h as H,i as Re,j as Ue,k as Be,c as Ie,V as De,a as m,b as N}from"./VTextField.85814425.js";import{V as G}from"./VSelect.b5351c97.js";import{V as Ee}from"./VFileInput.00cfca5f.js";import"./VList.facf17de.js";import"./VChip.22a06fed.js";const Me=pe()({name:"VTextarea",directives:{Intersect:se},inheritAttrs:!1,props:{autoGrow:Boolean,autofocus:Boolean,counter:[Boolean,Number,String],counterValue:Function,prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,noResize:Boolean,rows:{type:[Number,String],default:5,validator:e=>!isNaN(parseFloat(e))},maxRows:{type:[Number,String],validator:e=>!isNaN(parseFloat(e))},suffix:String,modelModifiers:Object,..._e(),...Ae()},emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,t){let{attrs:i,emit:u,slots:s}=t;const r=ve(e,"modelValue"),{isFocused:v,focus:y,blur:l}=Ne(e),L=S(()=>typeof e.counterValue=="function"?e.counterValue(r.value):(r.value||"").toString().length),Y=S(()=>{if(i.maxlength)return i.maxlength;if(!(!e.counter||typeof e.counter!="number"&&typeof e.counter!="string"))return e.counter});function K(o,c){var d,f;!e.autofocus||!o||(f=(d=c[0].target)==null?void 0:d.focus)==null||f.call(d)}const U=x(),w=x(),B=x(""),j=x(),Z=S(()=>v.value||e.persistentPlaceholder);function C(){var o;j.value!==document.activeElement&&((o=j.value)==null||o.focus()),v.value||y()}function J(o){C(),u("click:control",o)}function Q(o){u("mousedown:control",o)}function W(o){o.stopPropagation(),C(),_(()=>{r.value="",ke(e["onClick:clear"],o)})}function X(o){var d;const c=o.target;if(r.value=c.value,(d=e.modelModifiers)!=null&&d.trim){const f=[c.selectionStart,c.selectionEnd];_(()=>{c.selectionStart=f[0],c.selectionEnd=f[1]})}}const h=x();function g(){!e.autoGrow||_(()=>{if(!h.value||!w.value)return;const o=getComputedStyle(h.value),c=getComputedStyle(w.value.$el),d=parseFloat(o.getPropertyValue("--v-field-padding-top"))+parseFloat(o.getPropertyValue("--v-input-padding-top"))+parseFloat(o.getPropertyValue("--v-field-padding-bottom")),f=h.value.scrollHeight,F=parseFloat(o.lineHeight),$=Math.max(parseFloat(e.rows)*F+d,parseFloat(c.getPropertyValue("--v-input-control-height"))),P=parseFloat(e.maxRows)*F+d||1/0;B.value=we(je(f!=null?f:0,$,P))})}he(g),k(r,g),k(()=>e.rows,g),k(()=>e.maxRows,g),k(()=>e.density,g);let p;return k(h,o=>{o?(p=new ResizeObserver(g),p.observe(h.value)):p==null||p.disconnect()}),ge(()=>{p==null||p.disconnect()}),ne(()=>{const o=!!(s.counter||e.counter||e.counterValue),c=!!(o||s.details),[d,f]=be(i),[{modelValue:F,...$}]=H.filterProps(e),[P]=Re(e);return a(H,O({ref:U,modelValue:r.value,"onUpdate:modelValue":b=>r.value=b,class:["v-textarea v-text-field",{"v-textarea--prefixed":e.prefix,"v-textarea--suffixed":e.suffix,"v-text-field--prefixed":e.prefix,"v-text-field--suffixed":e.suffix,"v-textarea--auto-grow":e.autoGrow,"v-textarea--no-resize":e.noResize||e.autoGrow,"v-text-field--flush-details":["plain","underlined"].includes(e.variant)}]},d,$,{focused:v.value}),{...s,default:b=>{let{isDisabled:V,isDirty:I,isReadonly:ee,isValid:te}=b;return a(Ue,O({ref:w,style:{"--v-textarea-control-height":B.value},onClick:J,onMousedown:Q,"onClick:clear":W,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"],role:"textbox"},P,{active:Z.value||I.value,dirty:I.value||e.dirty,disabled:V.value,focused:v.value,error:te.value===!1}),{...s,default:ae=>{let{props:{class:D,...ie}}=ae;return a(T,null,[e.prefix&&a("span",{class:"v-text-field__prefix"},[e.prefix]),z(a("textarea",O({ref:j,class:D,value:r.value,onInput:X,autofocus:e.autofocus,readonly:ee.value,disabled:V.value,placeholder:e.placeholder,rows:e.rows,name:e.name,onFocus:C,onBlur:l},ie,f),null),[[Ve("intersect"),{handler:K},null,{once:!0}]]),e.autoGrow&&z(a("textarea",{class:[D,"v-textarea__sizer"],"onUpdate:modelValue":oe=>r.value=oe,ref:h,readonly:!0,"aria-hidden":"true"},null),[[xe,r.value]]),e.suffix&&a("span",{class:"v-text-field__suffix"},[e.suffix])])}})},details:c?b=>{var V;return a(T,null,[(V=s.details)==null?void 0:V.call(s,b),o&&a(T,null,[a("span",null,null),a(Be,{active:e.persistentCounter||v.value,value:L.value,max:Y.value},s.counter)])])}:void 0})}),re({},U,w,j)}}),qe={components:{navigation:le,foote:de},data:()=>({url:"https://top-lista-turista-default-rtdb.europe-west1.firebasedatabase.app/",fab:null,disabledBtn:!1,destinacija:{},naziv:null,opis:null,tip:null,prevoz:null,cena:null,maxOsoba:null,slike:null,isFormValid:null,opcijeTip:["Letovanje","Zimovanje","Gradovi Evrope"],opcijePrevoz:["Avion","Autobus","Sopstveni"],required:[e=>!!e||"Obavezno polje"],numeric:[e=>/^\d+$/.test(e)||"Mora biti broj"],numericPhone:[e=>/^[\+]?[(]?[0-9]{3}[)]?[-\s\.\\/]?[0-9]{2,6}[-\s\.]?[0-9]{2,6}[-\s\.]?[0-9]{1,6}$/.test(e)||"Neispravan telefon"],numericYear:[e=>+e>=1923&&+e<=new Date().getFullYear()||"Neispravna godina"],emailCheck:[e=>/[^@ \t\r\n]+@[^@ \t\r\n]+\.[^@ \t\r\n]+/.test(e)||"Neispravan email"],nameCheck:[e=>/^[a-z0-9_-]{2,20}$/.test(e)||"Neispravano korisni\u010Dko ime"],passCheck:[e=>/^(?=.*?[A-Z])(?=.*?[a-z])(?=.*?[0-9]).{8,}$/.test(e)||"Nedovoljno jaka lozinka"]}),computed:{fileCheck(){return[e=>!!e&&!!e.length||"Obavezno polje",e=>e.every(t=>!!t.size)||this.destinacija.slike.length&&e.length==this.destinacija.slike.length&&e.every((t,i)=>t.name==this.destinacija.slike[i].split("/").pop())||"Neispravan fajl",e=>e.every((t,i)=>this.destinacija.slike&&this.destinacija.slike.length>i&&t.name==this.destinacija.slike[i].split("/").pop()||t.size<1e7)||`Slika "${e.find(t=>"size"in t&&t.size>=1e7).name}" je prevelika!`]}},methods:{async uploadImage(e){const t=new FormData;return t.append("file",e),t.append("UPLOADCARE_STORE","auto"),t.append("UPLOADCARE_PUB_KEY","5e5635739f48855b98f7"),`https://ucarecdn.com/${(await(await fetch("https://upload.uploadcare.com/base/",{method:"POST",body:t})).json()).file}/${e.name}`},async submit(){let e,t;if(this.isFormValid){if(this.disabledBtn=!0,this.$route.params.id||(this.destinacija.slike=[]),"size"in this.slike[0]){this.destinacija.slike.length=0;for(let i=0;i<this.slike.length;i++)this.destinacija.slike.push(await this.uploadImage(this.slike[i]))}try{this.destinacija={tip:this.tip,opis:this.opis,cena:this.cena,naziv:this.naziv,slike:this.destinacija.slike,prevoz:this.prevoz,maxOsoba:this.maxOsoba};let i=await fetch(this.url+(this.$route.params.id?`/destinacije/${this.$route.params.agencijaId}/${this.$route.params.id}.json`:`/destinacije/${this.$route.params.agencijaId}.json`),{method:this.$route.params.id?"PATCH":"POST",body:JSON.stringify(this.destinacija),headers:{"Content-type":"application/json; charset=UTF-8"}});if(e=i.status,t=i.statusText,!i.ok)throw new Error;this.$router.go(-1)}catch(i){console.log(i),t=`Firebase: ${e}\xA0${t}`;const u="Ooops";this.$router.push({path:"/error",state:e==200?{}:{title:u,message:t}})}}},toTop(){window.scrollTo({top:0,behavior:"smooth"})},check(){this.fab=window.pageYOffset>60},async load_destinacije(e){let t,i;try{let u=await fetch(this.url+`/destinacije/${this.$route.params.agencijaId}.json`);if(t=u.status,i=u.statusText,!u.ok)throw new Error;const s=await u.json();console.log(s),console.log(e),this.destinacija={id:e,tip:s[e].tip,opis:s[e].opis,cena:s[e].cena,naziv:s[e].naziv,slike:s[e].slike,prevoz:s[e].prevoz,maxOsoba:s[e].maxOsoba},this.naziv=this.destinacija.naziv,this.opis=this.destinacija.opis,this.tip=this.destinacija.tip,this.prevoz=this.destinacija.prevoz,this.prevoz=this.prevoz.charAt(0).toUpperCase()+this.prevoz.slice(1),this.cena=this.destinacija.cena,this.maxOsoba=this.destinacija.maxOsoba,this.slike=this.destinacija.slike.map(r=>({name:r.split("/").pop()}))}catch(u){console.log(u),i=`Firebase: ${t}\xA0${i}`;const s="Ooops";this.$router.push({path:"/error",state:t==200?{}:{title:s,message:i}})}}},beforeMount(){this.$route.params.id&&this.load_destinacije(this.$route.params.id)}},He=e=>(Pe("data-v-28c56d81"),e=e(),Se(),e),Ge=He(()=>R("div",{class:"text-h4 font-weight-bold mb-2"},"Podaci",-1)),Le={id:"izbor"},Ye={id:"izbor"};function Ke(e,t,i,u,s,r){const v=q("navigation"),y=q("foote");return z((ze(),ye(ce,null,{default:n(()=>[a(v,{color:"secondary",flat:!1}),a(fe,null,{default:n(()=>[a(Te,{id:"content_holder_container"},{default:n(()=>[a(E,{id:"content_holder",class:"align-center text-center px-8 px-sm-12 px-md-16"},{default:n(()=>[a(E,{class:"kartica",width:"100%",variant:"outlined"},{default:n(()=>[a(Ie,{"model-value":e.isFormValid,"onUpdate:modelValue":t[7]||(t[7]=l=>e.isFormValid=l),onSubmit:t[8]||(t[8]=Ce(l=>r.submit(),["prevent"])),validate:"blur",ref:"forma",autocomplete:"off"},{default:n(()=>[a(De,{class:"pa-13 pt-7 px-5 px-sm-9 px-md-11 px-lg-13 justify-center"},{default:n(()=>[a(m,null,{default:n(()=>[Ge]),_:1}),a(m,{cols:"12"},{default:n(()=>[a(N,{rules:e.required,class:"mb-n4 text-left",variant:"outlined","bg-color":"#fff",label:"Naziv destinacije",modelValue:e.naziv,"onUpdate:modelValue":t[0]||(t[0]=l=>e.naziv=l)},null,8,["rules","modelValue"])]),_:1}),a(m,{md:"6",cols:"12"},{selection:n(({item:l})=>[R("span",Le,A(l.title),1)]),default:n(()=>[a(G,{rules:e.required,class:"mb-n4 text-left",variant:"outlined","bg-color":"#fff",label:"Tip",items:e.opcijeTip,modelValue:e.tip,"onUpdate:modelValue":t[1]||(t[1]=l=>e.tip=l)},null,8,["rules","items","modelValue"])]),_:1}),a(m,{md:"6",cols:"12"},{selection:n(({item:l})=>[R("span",Ye,A(l.title),1)]),default:n(()=>[a(G,{rules:e.required,class:"mb-n4 text-left",variant:"outlined","bg-color":"#fff",label:"Prevoz",items:e.opcijePrevoz,modelValue:e.prevoz,"onUpdate:modelValue":t[2]||(t[2]=l=>e.prevoz=l)},null,8,["rules","items","modelValue"])]),_:1}),a(m,{md:"6",cols:"12"},{default:n(()=>[a(N,{rules:[e.required,e.numeric].flat(),class:"mb-n4 text-left",variant:"outlined","bg-color":"#fff",label:"Cena",modelValue:e.cena,"onUpdate:modelValue":t[3]||(t[3]=l=>e.cena=l),suffix:"RSD"},null,8,["rules","modelValue"])]),_:1}),a(m,{md:"6",cols:"12"},{default:n(()=>[a(N,{rules:[e.required,e.numeric].flat(),class:"mb-n4 text-left",variant:"outlined","bg-color":"#fff",label:"Maksimalno osoba",modelValue:e.maxOsoba,"onUpdate:modelValue":t[4]||(t[4]=l=>e.maxOsoba=l)},null,8,["rules","modelValue"])]),_:1}),a(m,{cols:"12"},{default:n(()=>[a(Ee,{rules:r.fileCheck,class:"mb-n4 text-left",variant:"outlined","bg-color":"#fff",label:"Slike",modelValue:e.slike,"onUpdate:modelValue":t[5]||(t[5]=l=>e.slike=l),accept:"image/*",multiple:"",chips:"","prepend-icon":"","prepend-inner-icon":"mdi-paperclip"},null,8,["rules","modelValue"])]),_:1}),a(m,{cols:"12"},{default:n(()=>[a(Me,{rules:e.required,class:"mb-n4 text-left",variant:"outlined","bg-color":"#fff",label:"Opis",modelValue:e.opis,"onUpdate:modelValue":t[6]||(t[6]=l=>e.opis=l),"auto-grow":""},null,8,["rules","modelValue"])]),_:1}),a(m,{md:"3",cols:"12"},{default:n(()=>[a(M,{type:"submit",class:"bg-white mt-4",style:{"font-weight":"600"},variant:"outlined",width:"100%",height:"44px",disabled:e.disabledBtn},{default:n(()=>[Fe(A(this.$route.params.id?"A\u017Euriraj":"Dodaj"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["model-value"])]),_:1})]),_:1})]),_:1})]),_:1}),a(me,null,{default:n(()=>[z(a(M,{fab:"",dark:"",fixed:"",bottom:"",right:"",class:"topFab",color:"#bfb7a7",icon:"mdi-arrow-up",onClick:r.toTop},null,8,["onClick"]),[[$e,e.fab]])]),_:1}),a(y,{mediaLinks:!1})]),_:1})),[[Oe,r.check]])}const ot=ue(qe,[["render",Ke],["__scopeId","data-v-28c56d81"]]);export{ot as default};
