import{n as le}from"./AdminBar.61f7bac9.js";import{K as se,e as ne,x as re,_ as ue,f as de,h as ce,V as E,j as M,i as fe,k as me}from"./VMain.bb3aa9c0.js";import{h as pe,_ as ve,m as $,i as x,K as he,k,l as ge,ax as be,a,x as O,F as I,q as z,af as Ve,aF as xe,ad as T,az as ke,O as je,n as we,r as q,o as ze,c as ye,w as r,s as Ce,b as N,t as _,f as Fe,v as Pe,p as Se,g as $e}from"./index.395a7d4a.js";import{S as Oe,V as Ie}from"./index.3153ceab.js";import{e as Te,f as _e,g as Ae,h as H,i as Ne,j as Re,k as Ue,c as De,V as Be,a as p,b as A}from"./VTextField.d47620c9.js";import{V as G}from"./VSelect.77d45519.js";import{V as Ee}from"./VFileInput.406b7f55.js";import"./VList.7fe07c76.js";import"./VChip.562dba7a.js";const Me=pe()({name:"VTextarea",directives:{Intersect:se},inheritAttrs:!1,props:{autoGrow:Boolean,autofocus:Boolean,counter:[Boolean,Number,String],counterValue:Function,prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,noResize:Boolean,rows:{type:[Number,String],default:5,validator:e=>!isNaN(parseFloat(e))},maxRows:{type:[Number,String],validator:e=>!isNaN(parseFloat(e))},suffix:String,modelModifiers:Object,...Te(),..._e()},emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,t){let{attrs:o,emit:d,slots:s}=t;const i=ve(e,"modelValue"),{isFocused:u,focus:y,blur:n}=Ae(e),L=$(()=>typeof e.counterValue=="function"?e.counterValue(i.value):(i.value||"").toString().length),Y=$(()=>{if(o.maxlength)return o.maxlength;if(!(!e.counter||typeof e.counter!="number"&&typeof e.counter!="string"))return e.counter});function K(l,f){var c,m;!e.autofocus||!l||(m=(c=f[0].target)==null?void 0:c.focus)==null||m.call(c)}const R=x(),j=x(),U=x(""),w=x(),Z=$(()=>u.value||e.persistentPlaceholder);function C(){var l;w.value!==document.activeElement&&((l=w.value)==null||l.focus()),u.value||y()}function J(l){C(),d("click:control",l)}function Q(l){d("mousedown:control",l)}function W(l){l.stopPropagation(),C(),T(()=>{i.value="",ke(e["onClick:clear"],l)})}function X(l){var c;const f=l.target;if(i.value=f.value,(c=e.modelModifiers)!=null&&c.trim){const m=[f.selectionStart,f.selectionEnd];T(()=>{f.selectionStart=m[0],f.selectionEnd=m[1]})}}const h=x();function g(){!e.autoGrow||T(()=>{if(!h.value||!j.value)return;const l=getComputedStyle(h.value),f=getComputedStyle(j.value.$el),c=parseFloat(l.getPropertyValue("--v-field-padding-top"))+parseFloat(l.getPropertyValue("--v-input-padding-top"))+parseFloat(l.getPropertyValue("--v-field-padding-bottom")),m=h.value.scrollHeight,F=parseFloat(l.lineHeight),P=Math.max(parseFloat(e.rows)*F+c,parseFloat(f.getPropertyValue("--v-input-control-height"))),S=parseFloat(e.maxRows)*F+c||1/0;U.value=je(we(m!=null?m:0,P,S))})}he(g),k(i,g),k(()=>e.rows,g),k(()=>e.maxRows,g),k(()=>e.density,g);let v;return k(h,l=>{l?(v=new ResizeObserver(g),v.observe(h.value)):v==null||v.disconnect()}),ge(()=>{v==null||v.disconnect()}),ne(()=>{const l=!!(s.counter||e.counter||e.counterValue),f=!!(l||s.details),[c,m]=be(o),[{modelValue:F,...P}]=H.filterProps(e),[S]=Ne(e);return a(H,O({ref:R,modelValue:i.value,"onUpdate:modelValue":b=>i.value=b,class:["v-textarea v-text-field",{"v-textarea--prefixed":e.prefix,"v-textarea--suffixed":e.suffix,"v-text-field--prefixed":e.prefix,"v-text-field--suffixed":e.suffix,"v-textarea--auto-grow":e.autoGrow,"v-textarea--no-resize":e.noResize||e.autoGrow,"v-text-field--flush-details":["plain","underlined"].includes(e.variant)}]},c,P,{focused:u.value}),{...s,default:b=>{let{isDisabled:V,isDirty:D,isReadonly:ee,isValid:te}=b;return a(Re,O({ref:j,style:{"--v-textarea-control-height":U.value},onClick:J,onMousedown:Q,"onClick:clear":W,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"],role:"textbox"},S,{active:Z.value||D.value,dirty:D.value||e.dirty,disabled:V.value,focused:u.value,error:te.value===!1}),{...s,default:ae=>{let{props:{class:B,...ie}}=ae;return a(I,null,[e.prefix&&a("span",{class:"v-text-field__prefix"},[e.prefix]),z(a("textarea",O({ref:w,class:B,value:i.value,onInput:X,autofocus:e.autofocus,readonly:ee.value,disabled:V.value,placeholder:e.placeholder,rows:e.rows,name:e.name,onFocus:C,onBlur:n},ie,m),null),[[Ve("intersect"),{handler:K},null,{once:!0}]]),e.autoGrow&&z(a("textarea",{class:[B,"v-textarea__sizer"],"onUpdate:modelValue":oe=>i.value=oe,ref:h,readonly:!0,"aria-hidden":"true"},null),[[xe,i.value]]),e.suffix&&a("span",{class:"v-text-field__suffix"},[e.suffix])])}})},details:f?b=>{var V;return a(I,null,[(V=s.details)==null?void 0:V.call(s,b),l&&a(I,null,[a("span",null,null),a(Ue,{active:e.persistentCounter||u.value,value:L.value,max:Y.value},s.counter)])])}:void 0})}),re({},R,j,w)}}),qe={components:{navigation:le,foote:de},data:()=>({url:"https://top-lista-turista-default-rtdb.europe-west1.firebasedatabase.app/",fab:null,destinacija:{},naziv:null,opis:null,tip:null,prevoz:null,cena:null,maxOsoba:null,slike:null,isFormValid:null,opcijeTip:["Letovanje","Zimovanje","Gradovi Evrope"],opcijePrevoz:["Avion","Autobus","Sopstveni"],required:[e=>!!e||"Obavezno polje"],numeric:[e=>/^\d+$/.test(e)||"Mora biti broj"],numericPhone:[e=>/^[\+]?[(]?[0-9]{3}[)]?[-\s\.\\/]?[0-9]{2,6}[-\s\.]?[0-9]{2,6}[-\s\.]?[0-9]{1,6}$/.test(e)||"Neispravan telefon"],numericYear:[e=>+e>=1923&&+e<=new Date().getFullYear()||"Neispravna godina"],emailCheck:[e=>/[^@ \t\r\n]+@[^@ \t\r\n]+\.[^@ \t\r\n]+/.test(e)||"Neispravan email"],nameCheck:[e=>/^[a-z0-9_-]{2,20}$/.test(e)||"Neispravano korisni\u010Dko ime"],passCheck:[e=>/^(?=.*?[A-Z])(?=.*?[a-z])(?=.*?[0-9]).{8,}$/.test(e)||"Nedovoljno jaka lozinka"]}),computed:{fileCheck(){return[e=>!!e&&!!e.length||"Obavezno polje",e=>e.every(t=>!!t.size)||this.destinacija.slike.length&&e.length==this.destinacija.slike.length&&e.every((t,o)=>t.name==this.destinacija.slike[o].split("/").pop())||"Neispravan fajl",e=>e.every((t,o)=>this.destinacija.slike&&this.destinacija.slike.length>o&&t.name==this.destinacija.slike[o].split("/").pop()||t.size<1e7)||`Slika "${e.find(t=>"size"in t&&t.size>=1e7).name}" je prevelika!`]}},methods:{async uploadImage(e){const t=new FormData;return t.append("file",e),t.append("UPLOADCARE_STORE","auto"),t.append("UPLOADCARE_PUB_KEY","5e5635739f48855b98f7"),`https://ucarecdn.com/${(await(await fetch("https://upload.uploadcare.com/base/",{method:"POST",body:t})).json()).file}/${e.name}`},async submit(){let e,t;if(this.isFormValid){if(this.$route.params.id||(this.destinacija.slike=[]),"size"in this.slike[0]){this.destinacija.slike.length=0;for(let o=0;o<this.slike.length;o++)this.destinacija.slike.push(await this.uploadImage(this.slike[o]))}try{this.destinacija={tip:this.tip,opis:this.opis,cena:this.cena,naziv:this.naziv,slike:this.destinacija.slike,prevoz:this.prevoz,maxOsoba:this.maxOsoba};let o=await fetch(this.url+(this.$route.params.id?`/destinacije/${this.$route.params.agencijaId}/${this.$route.params.id}.json`:`/destinacije/${this.$route.params.agencijaId}.json`),{method:this.$route.params.id?"PATCH":"POST",body:JSON.stringify(this.destinacija),headers:{"Content-type":"application/json; charset=UTF-8"}});if(e=o.status,t=o.statusText,!o.ok)throw new Error;this.$router.go(-1)}catch(o){console.log(o),t=`Firebase: ${e}\xA0${t}`;const d="Ooops";this.$router.push({path:"/error",state:e==200?{}:{title:d,message:t}})}}},toTop(){window.scrollTo({top:0,behavior:"smooth"})},check(){this.fab=window.pageYOffset>60},async load_destinacije(e){let t,o;try{let d=await fetch(this.url+"/destinacije.json");if(t=d.status,o=d.statusText,!d.ok)throw new Error;const s=await d.json();console.log(s),console.log(e);for(const i in s)for(const u in s[i])u==e&&(this.destinacija={id:u,tip:s[i][u].tip,opis:s[i][u].opis,cena:s[i][u].cena,naziv:s[i][u].naziv,slike:s[i][u].slike,prevoz:s[i][u].prevoz,maxOsoba:s[i][u].maxOsoba});this.naziv=this.destinacija.naziv,this.opis=this.destinacija.opis,this.tip=this.destinacija.tip,this.prevoz=this.destinacija.prevoz,this.prevoz=this.prevoz.charAt(0).toUpperCase()+this.prevoz.slice(1),this.cena=this.destinacija.cena,this.maxOsoba=this.destinacija.maxOsoba,this.slike=this.destinacija.slike.map(i=>({name:i.split("/").pop()}))}catch(d){console.log(d),o=`Firebase: ${t}\xA0${o}`;const s="Ooops";this.$router.push({path:"/error",state:t==200?{}:{title:s,message:o}})}}},beforeMount(){this.$route.params.id&&this.load_destinacije(this.$route.params.id)}},He=e=>(Se("data-v-5c13a210"),e=e(),$e(),e),Ge=He(()=>N("div",{class:"text-h4 font-weight-bold mb-2"},"Podaci",-1)),Le={id:"izbor"},Ye={id:"izbor"};function Ke(e,t,o,d,s,i){const u=q("navigation"),y=q("foote");return z((ze(),ye(ce,null,{default:r(()=>[a(u,{color:"secondary",flat:!1}),a(fe,null,{default:r(()=>[a(Ie,{id:"content_holder_container"},{default:r(()=>[a(E,{id:"content_holder",class:"align-center text-center px-8 px-sm-12 px-md-16"},{default:r(()=>[a(E,{class:"kartica",width:"100%",variant:"outlined"},{default:r(()=>[a(De,{"model-value":e.isFormValid,"onUpdate:modelValue":t[7]||(t[7]=n=>e.isFormValid=n),onSubmit:t[8]||(t[8]=Ce(n=>i.submit(),["prevent"])),validate:"blur",ref:"forma",autocomplete:"off"},{default:r(()=>[a(Be,{class:"pa-13 pt-7 px-5 px-sm-9 px-md-11 px-lg-13 justify-center"},{default:r(()=>[a(p,null,{default:r(()=>[Ge]),_:1}),a(p,{cols:"12"},{default:r(()=>[a(A,{rules:e.required,class:"mb-n4 text-left",variant:"outlined","bg-color":"#fff",label:"Naziv destinacije",modelValue:e.naziv,"onUpdate:modelValue":t[0]||(t[0]=n=>e.naziv=n)},null,8,["rules","modelValue"])]),_:1}),a(p,{md:"6",cols:"12"},{selection:r(({item:n})=>[N("span",Le,_(n.title),1)]),default:r(()=>[a(G,{rules:e.required,class:"mb-n4 text-left",variant:"outlined","bg-color":"#fff",label:"Tip",items:e.opcijeTip,modelValue:e.tip,"onUpdate:modelValue":t[1]||(t[1]=n=>e.tip=n)},null,8,["rules","items","modelValue"])]),_:1}),a(p,{md:"6",cols:"12"},{selection:r(({item:n})=>[N("span",Ye,_(n.title),1)]),default:r(()=>[a(G,{rules:e.required,class:"mb-n4 text-left",variant:"outlined","bg-color":"#fff",label:"Prevoz",items:e.opcijePrevoz,modelValue:e.prevoz,"onUpdate:modelValue":t[2]||(t[2]=n=>e.prevoz=n)},null,8,["rules","items","modelValue"])]),_:1}),a(p,{md:"6",cols:"12"},{default:r(()=>[a(A,{rules:[e.required,e.numeric].flat(),class:"mb-n4 text-left",variant:"outlined","bg-color":"#fff",label:"Cena",modelValue:e.cena,"onUpdate:modelValue":t[3]||(t[3]=n=>e.cena=n),suffix:"RSD"},null,8,["rules","modelValue"])]),_:1}),a(p,{md:"6",cols:"12"},{default:r(()=>[a(A,{rules:[e.required,e.numeric].flat(),class:"mb-n4 text-left",variant:"outlined","bg-color":"#fff",label:"Maksimalno osoba",modelValue:e.maxOsoba,"onUpdate:modelValue":t[4]||(t[4]=n=>e.maxOsoba=n)},null,8,["rules","modelValue"])]),_:1}),a(p,{cols:"12"},{default:r(()=>[a(Ee,{rules:i.fileCheck,class:"mb-n4 text-left",variant:"outlined","bg-color":"#fff",label:"Slike",modelValue:e.slike,"onUpdate:modelValue":t[5]||(t[5]=n=>e.slike=n),accept:"image/*",multiple:"",chips:"","prepend-icon":"","prepend-inner-icon":"mdi-paperclip"},null,8,["rules","modelValue"])]),_:1}),a(p,{cols:"12"},{default:r(()=>[a(Me,{rules:e.required,class:"mb-n4 text-left",variant:"outlined","bg-color":"#fff",label:"Opis",modelValue:e.opis,"onUpdate:modelValue":t[6]||(t[6]=n=>e.opis=n),"auto-grow":""},null,8,["rules","modelValue"])]),_:1}),a(p,{md:"3",cols:"12"},{default:r(()=>[a(M,{type:"submit",class:"bg-white mt-4",style:{"font-weight":"600"},variant:"outlined",width:"100%",height:"44px"},{default:r(()=>[Fe(_(this.$route.params.id?"A\u017Euriraj":"Dodaj"),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])]),_:1})]),_:1})]),_:1})]),_:1}),a(me,null,{default:r(()=>[z(a(M,{fab:"",dark:"",fixed:"",bottom:"",right:"",class:"topFab",color:"#bfb7a7",icon:"mdi-arrow-up",onClick:i.toTop},null,8,["onClick"]),[[Pe,e.fab]])]),_:1}),a(y,{mediaLinks:!1})]),_:1})),[[Oe,i.check]])}const ot=ue(qe,[["render",Ke],["__scopeId","data-v-5c13a210"]]);export{ot as default};
