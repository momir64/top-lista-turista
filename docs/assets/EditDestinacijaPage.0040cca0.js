import{n as se}from"./AdminBar.94d7c186.js";import{I as ne,e as re,s as ue,_ as de,f as ce,h as fe,V as O,j as T,i as me,k as pe,b as ve,ah as he,p as ge}from"./VMain.b2afb40f.js";import{h as be,$ as Ve,m as A,i as k,L as ke,k as j,l as je,ay as we,a,y as D,F as U,s as y,ag as xe,aF as ze,ae as N,aA as ye,P as Ce,q as $e,r as _,o as Fe,c as Pe,w as o,x as Se,b as I,t as z,f as R,v as Oe,p as Te,g as Ae}from"./index.3097002d.js";import{S as De,V as Ue}from"./index.5614d2ef.js";import{e as Ne,f as Re,g as Be,h as G,i as Ie,j as Ee,k as Me,c as qe,V as He,a as m,b as B}from"./VTextField.c5d09d7d.js";import{V as L}from"./VSelect.746437a9.js";import{V as _e}from"./VFileInput.04c93a03.js";import"./VList.be435b2d.js";import"./VChip.d74aa10a.js";const Ge=be()({name:"VTextarea",directives:{Intersect:ne},inheritAttrs:!1,props:{autoGrow:Boolean,autofocus:Boolean,counter:[Boolean,Number,String],counterValue:Function,prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,noResize:Boolean,rows:{type:[Number,String],default:5,validator:e=>!isNaN(parseFloat(e))},maxRows:{type:[Number,String],validator:e=>!isNaN(parseFloat(e))},suffix:String,modelModifiers:Object,...Ne(),...Re()},emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,t){let{attrs:i,emit:u,slots:n}=t;const r=Ve(e,"modelValue"),{isFocused:v,focus:C,blur:l}=Be(e),Y=A(()=>typeof e.counterValue=="function"?e.counterValue(r.value):(r.value||"").toString().length),Z=A(()=>{if(i.maxlength)return i.maxlength;if(!(!e.counter||typeof e.counter!="number"&&typeof e.counter!="string"))return e.counter});function J(s,c){var d,f;!e.autofocus||!s||(f=(d=c[0].target)==null?void 0:d.focus)==null||f.call(d)}const E=k(),w=k(),M=k(""),x=k(),K=A(()=>v.value||e.persistentPlaceholder);function $(){var s;x.value!==document.activeElement&&((s=x.value)==null||s.focus()),v.value||C()}function Q(s){$(),u("click:control",s)}function W(s){u("mousedown:control",s)}function X(s){s.stopPropagation(),$(),N(()=>{r.value="",ye(e["onClick:clear"],s)})}function ee(s){var d;const c=s.target;if(r.value=c.value,(d=e.modelModifiers)!=null&&d.trim){const f=[c.selectionStart,c.selectionEnd];N(()=>{c.selectionStart=f[0],c.selectionEnd=f[1]})}}const h=k();function g(){!e.autoGrow||N(()=>{if(!h.value||!w.value)return;const s=getComputedStyle(h.value),c=getComputedStyle(w.value.$el),d=parseFloat(s.getPropertyValue("--v-field-padding-top"))+parseFloat(s.getPropertyValue("--v-input-padding-top"))+parseFloat(s.getPropertyValue("--v-field-padding-bottom")),f=h.value.scrollHeight,F=parseFloat(s.lineHeight),P=Math.max(parseFloat(e.rows)*F+d,parseFloat(c.getPropertyValue("--v-input-control-height"))),S=parseFloat(e.maxRows)*F+d||1/0;M.value=Ce($e(f!=null?f:0,P,S))})}ke(g),j(r,g),j(()=>e.rows,g),j(()=>e.maxRows,g),j(()=>e.density,g);let p;return j(h,s=>{s?(p=new ResizeObserver(g),p.observe(h.value)):p==null||p.disconnect()}),je(()=>{p==null||p.disconnect()}),re(()=>{const s=!!(n.counter||e.counter||e.counterValue),c=!!(s||n.details),[d,f]=we(i),[{modelValue:F,...P}]=G.filterProps(e),[S]=Ie(e);return a(G,D({ref:E,modelValue:r.value,"onUpdate:modelValue":b=>r.value=b,class:["v-textarea v-text-field",{"v-textarea--prefixed":e.prefix,"v-textarea--suffixed":e.suffix,"v-text-field--prefixed":e.prefix,"v-text-field--suffixed":e.suffix,"v-textarea--auto-grow":e.autoGrow,"v-textarea--no-resize":e.noResize||e.autoGrow,"v-text-field--flush-details":["plain","underlined"].includes(e.variant)}]},d,P,{focused:v.value}),{...n,default:b=>{let{isDisabled:V,isDirty:q,isReadonly:te,isValid:ae}=b;return a(Ee,D({ref:w,style:{"--v-textarea-control-height":M.value},onClick:Q,onMousedown:W,"onClick:clear":X,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"],role:"textbox"},S,{active:K.value||q.value,dirty:q.value||e.dirty,disabled:V.value,focused:v.value,error:ae.value===!1}),{...n,default:ie=>{let{props:{class:H,...le}}=ie;return a(U,null,[e.prefix&&a("span",{class:"v-text-field__prefix"},[e.prefix]),y(a("textarea",D({ref:x,class:H,value:r.value,onInput:ee,autofocus:e.autofocus,readonly:te.value,disabled:V.value,placeholder:e.placeholder,rows:e.rows,name:e.name,onFocus:$,onBlur:l},le,f),null),[[xe("intersect"),{handler:J},null,{once:!0}]]),e.autoGrow&&y(a("textarea",{class:[H,"v-textarea__sizer"],"onUpdate:modelValue":oe=>r.value=oe,ref:h,readonly:!0,"aria-hidden":"true"},null),[[ze,r.value]]),e.suffix&&a("span",{class:"v-text-field__suffix"},[e.suffix])])}})},details:c?b=>{var V;return a(U,null,[(V=n.details)==null?void 0:V.call(n,b),s&&a(U,null,[a("span",null,null),a(Me,{active:e.persistentCounter||v.value,value:Y.value,max:Z.value},n.counter)])])}:void 0})}),ue({},E,w,x)}}),Le={components:{navigation:se,foote:ce},data:()=>({url:"https://top-lista-turista-default-rtdb.europe-west1.firebasedatabase.app/",fab:null,disabledBtn:!1,okDialog:!1,destinacija:{},naziv:null,opis:null,tip:null,prevoz:null,cena:null,maxOsoba:null,slike:null,isFormValid:null,opcijeTip:["Letovanje","Zimovanje","Gradovi Evrope"],opcijePrevoz:["Avion","Autobus","Sopstveni"],required:[e=>!!e||"Obavezno polje"],numeric:[e=>/^\d+$/.test(e)||"Mora biti broj"],numericPhone:[e=>/^[\+]?[(]?[0-9]{3}[)]?[-\s\.\\/]?[0-9]{2,6}[-\s\.]?[0-9]{2,6}[-\s\.]?[0-9]{1,6}$/.test(e)||"Neispravan telefon"],numericYear:[e=>+e>=1923&&+e<=new Date().getFullYear()||"Neispravna godina"],emailCheck:[e=>/[^@ \t\r\n]+@[^@ \t\r\n]+\.[^@ \t\r\n]+/.test(e)||"Neispravan email"],nameCheck:[e=>/^[a-z0-9_-]{2,20}$/.test(e)||"Neispravano korisni\u010Dko ime"],passCheck:[e=>/^(?=.*?[A-Z])(?=.*?[a-z])(?=.*?[0-9]).{8,}$/.test(e)||"Nedovoljno jaka lozinka"]}),computed:{fileCheck(){return[e=>!!e&&!!e.length||"Obavezno polje",e=>e.every(t=>!!t.size)||this.destinacija.slike.length&&e.length==this.destinacija.slike.length&&e.every((t,i)=>t.name==this.destinacija.slike[i].split("/").pop())||"Neispravan fajl",e=>e.every((t,i)=>this.destinacija.slike&&this.destinacija.slike.length>i&&t.name==this.destinacija.slike[i].split("/").pop()||t.size<1e7)||`Slika "${e.find(t=>"size"in t&&t.size>=1e7).name}" je prevelika!`]}},methods:{async uploadImage(e){const t=new FormData;return t.append("file",e),t.append("UPLOADCARE_STORE","auto"),t.append("UPLOADCARE_PUB_KEY","5e5635739f48855b98f7"),`https://ucarecdn.com/${(await(await fetch("https://upload.uploadcare.com/base/",{method:"POST",body:t})).json()).file}/${e.name}`},async submit(){let e,t;if(this.isFormValid){if(this.disabledBtn=!0,this.$route.params.id||(this.destinacija.slike=[]),"size"in this.slike[0]){this.destinacija.slike.length=0;for(let i=0;i<this.slike.length;i++)this.destinacija.slike.push(await this.uploadImage(this.slike[i]))}try{this.destinacija={tip:this.tip,opis:this.opis,cena:this.cena,naziv:this.naziv,slike:this.destinacija.slike,prevoz:this.prevoz,maxOsoba:this.maxOsoba};let i=await fetch(this.url+(this.$route.params.id?`/destinacije/${this.$route.params.agencijaId}/${this.$route.params.id}.json`:`/destinacije/${this.$route.params.agencijaId}.json`),{method:this.$route.params.id?"PATCH":"POST",body:JSON.stringify(this.destinacija),headers:{"Content-type":"application/json; charset=UTF-8"}});if(e=i.status,t=i.statusText,!i.ok)throw new Error;this.okDialog=!0}catch(i){console.log(i),t=`Firebase: ${e}\xA0${t}`;const u="Ooops";this.$router.push({path:"/error",state:e==200?{}:{title:u,message:t}})}}},toTop(){window.scrollTo({top:0,behavior:"smooth"})},check(){this.fab=window.pageYOffset>60},async load_destinacije(e){let t,i;try{let u=await fetch(this.url+`/destinacije/${this.$route.params.agencijaId}.json`);if(t=u.status,i=u.statusText,!u.ok)throw new Error;const n=await u.json();console.log(n),console.log(e),this.destinacija={id:e,tip:n[e].tip,opis:n[e].opis,cena:n[e].cena,naziv:n[e].naziv,slike:n[e].slike,prevoz:n[e].prevoz,maxOsoba:n[e].maxOsoba},this.naziv=this.destinacija.naziv,this.opis=this.destinacija.opis,this.tip=this.destinacija.tip,this.prevoz=this.destinacija.prevoz,this.prevoz=this.prevoz.charAt(0).toUpperCase()+this.prevoz.slice(1),this.cena=this.destinacija.cena,this.maxOsoba=this.destinacija.maxOsoba,this.slike=this.destinacija.slike.map(r=>({name:r.split("/").pop()}))}catch(u){console.log(u),i=`Firebase: ${t}\xA0${i}`;const n="Ooops";this.$router.push({path:"/error",state:t==200?{}:{title:n,message:i}})}}},beforeMount(){this.$route.params.id&&this.load_destinacije(this.$route.params.id)}},Ye=e=>(Te("data-v-d46fe0fc"),e=e(),Ae(),e),Ze=Ye(()=>I("div",{class:"text-h4 font-weight-bold mb-2"},"Podaci",-1)),Je={id:"izbor"},Ke={id:"izbor"};function Qe(e,t,i,u,n,r){const v=_("navigation"),C=_("foote");return y((Fe(),Pe(fe,null,{default:o(()=>[a(v,{color:"secondary",flat:!1}),a(me,null,{default:o(()=>[a(Ue,{id:"content_holder_container"},{default:o(()=>[a(O,{id:"content_holder",class:"align-center text-center px-8 px-sm-12 px-md-16"},{default:o(()=>[a(O,{class:"kartica",width:"100%",variant:"outlined"},{default:o(()=>[a(qe,{"model-value":e.isFormValid,"onUpdate:modelValue":t[7]||(t[7]=l=>e.isFormValid=l),onSubmit:t[8]||(t[8]=Se(l=>r.submit(),["prevent"])),validate:"blur",ref:"forma",autocomplete:"off"},{default:o(()=>[a(He,{class:"pa-13 pt-7 px-5 px-sm-9 px-md-11 px-lg-13 justify-center"},{default:o(()=>[a(m,null,{default:o(()=>[Ze]),_:1}),a(m,{cols:"12"},{default:o(()=>[a(B,{rules:e.required,class:"mb-n4 text-left",variant:"outlined","bg-color":"#fff",label:"Naziv destinacije",modelValue:e.naziv,"onUpdate:modelValue":t[0]||(t[0]=l=>e.naziv=l)},null,8,["rules","modelValue"])]),_:1}),a(m,{md:"6",cols:"12"},{selection:o(({item:l})=>[I("span",Je,z(l.title),1)]),default:o(()=>[a(L,{rules:e.required,class:"mb-n4 text-left",variant:"outlined","bg-color":"#fff",label:"Tip",items:e.opcijeTip,modelValue:e.tip,"onUpdate:modelValue":t[1]||(t[1]=l=>e.tip=l)},null,8,["rules","items","modelValue"])]),_:1}),a(m,{md:"6",cols:"12"},{selection:o(({item:l})=>[I("span",Ke,z(l.title),1)]),default:o(()=>[a(L,{rules:e.required,class:"mb-n4 text-left",variant:"outlined","bg-color":"#fff",label:"Prevoz",items:e.opcijePrevoz,modelValue:e.prevoz,"onUpdate:modelValue":t[2]||(t[2]=l=>e.prevoz=l)},null,8,["rules","items","modelValue"])]),_:1}),a(m,{md:"6",cols:"12"},{default:o(()=>[a(B,{rules:[e.required,e.numeric].flat(),class:"mb-n4 text-left",variant:"outlined","bg-color":"#fff",label:"Cena",modelValue:e.cena,"onUpdate:modelValue":t[3]||(t[3]=l=>e.cena=l),suffix:"RSD"},null,8,["rules","modelValue"])]),_:1}),a(m,{md:"6",cols:"12"},{default:o(()=>[a(B,{rules:[e.required,e.numeric].flat(),class:"mb-n4 text-left",variant:"outlined","bg-color":"#fff",label:"Maksimalno osoba",modelValue:e.maxOsoba,"onUpdate:modelValue":t[4]||(t[4]=l=>e.maxOsoba=l)},null,8,["rules","modelValue"])]),_:1}),a(m,{cols:"12"},{default:o(()=>[a(_e,{rules:r.fileCheck,class:"mb-n4 text-left",variant:"outlined","bg-color":"#fff",label:"Slike",modelValue:e.slike,"onUpdate:modelValue":t[5]||(t[5]=l=>e.slike=l),accept:"image/*",multiple:"",chips:"","prepend-icon":"","prepend-inner-icon":"mdi-paperclip"},null,8,["rules","modelValue"])]),_:1}),a(m,{cols:"12"},{default:o(()=>[a(Ge,{rules:e.required,class:"mb-n4 text-left",variant:"outlined","bg-color":"#fff",label:"Opis",modelValue:e.opis,"onUpdate:modelValue":t[6]||(t[6]=l=>e.opis=l),"auto-grow":""},null,8,["rules","modelValue"])]),_:1}),a(m,{md:"3",cols:"12"},{default:o(()=>[a(T,{type:"submit",class:"bg-white mt-4",style:{"font-weight":"600"},variant:"outlined",width:"100%",height:"44px",disabled:e.disabledBtn},{default:o(()=>[R(z(this.$route.params.id?"A\u017Euriraj":"Dodaj"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["model-value"])]),_:1})]),_:1})]),_:1})]),_:1}),a(pe,null,{default:o(()=>[y(a(T,{fab:"",dark:"",fixed:"",bottom:"",right:"",class:"topFab",color:"#bfb7a7",icon:"mdi-arrow-up",onClick:r.toTop},null,8,["onClick"]),[[Oe,e.fab]])]),_:1}),a(C,{mediaLinks:!1}),a(ge,{modelValue:e.okDialog,"onUpdate:modelValue":t[10]||(t[10]=l=>e.okDialog=l),width:"auto",persistent:""},{default:o(()=>[a(O,{class:"kartica_dijalog pa-4"},{default:o(()=>[a(ve,{class:"text-wrap text-center mb-4 mt-1"},{default:o(()=>[R(z(this.$route.params.id?`Uspe\u0161na izmena destinacije ${e.naziv}!`:`Uspe\u0161no dodavanje destinacije ${e.naziv}!`),1)]),_:1}),a(he,{class:"justify-center"},{default:o(()=>[a(T,{style:{"border-radius":"13px"},variant:"text",onClick:t[9]||(t[9]=l=>{e.okDialog=!1,this.$router.go(-1),e.disabledBtn=!1,this.$route.params.id||(e.naziv=null,e.opis=null,e.tip=null,e.prevoz=null,e.cena=null,e.maxOsoba=null,e.slike=null)})},{default:o(()=>[R(" Ok ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})),[[De,r.check]])}const nt=de(Le,[["render",Qe],["__scopeId","data-v-d46fe0fc"]]);export{nt as default};
